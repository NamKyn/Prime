<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <title> The Next Prime Order</title>
  <style>
body {
    width: 100vw;
    height : 100vh;
    vertical-align: middle;
}
.myDiv {
  border: 1px outset red;
  background-color: lightblue;
  text-align: center;
}
#out1 {
  background-color: white;
  text-align: center;
  width: 100%;
}
.div3 {
	vertical-align: center;
	background-color: lightgreen;
	width: 100%;
	text-align: center;
}
.div5 {
	background-color: orange;
	width: 100%;
	text-align: center;
}

#all {
    width: 100vw;
    height: 100vw;
}
  </style> 
  </head>

  <body>
    <div id="all" class="myDiv">
	    <div class="div5"></div>
	   <div class="div1" id="div10">
		    <form id="prim">
			    <span>
				    <p>  <label for="no1"> Distributive Worth: </label> </p>
			    <input name="number" type="number" id="no1" max=9600 value=12 required>
			    <input type="submit" value="Factorise" id="sub1" style="background-color:blue;color:white">
			    </span>
			    <span>
				    <p>  <label for="fact"> Numbers Of Persons: </label> </p>
			    <select name="factor" id="fact"></select>
			    <input type="submit" value="Distribute" id="sub2" style="background-color:blue;color:white">
			    </span>
		    </form>
	    </div>
	    <div class="div2"><table id="out1">
		    <tr id="outa"></tr>
		    </table>
	    </div>
	    <div class="div5"></div>
	    <div class="div3"></div>
	    <script async type="text/javascript">
const btn = document.querySelector('#sub1');
const form = document.querySelector('#prim');
const inp = document.querySelector('#no1');
const fact = document.querySelector('#fact');
const btn2 = document.querySelector('#sub2');
const div5 = document.querySelector('.div5');
const factors = number => [...Array(number + 1).keys()].filter(i=>number % i === 0);
const primes = number => [...Array(number + 1).keys()].filter(i => isPrime(i));

const leastFactor = function(n){
 if (isNaN(n) || !isFinite(n)) return NaN;  
 if (n==0) return 0;  
 if (n%1 || n*n<2) return 1;
 if (n%2==0) return 2;  
 if (n%3==0) return 3;  
 if (n%5==0) return 5;  
 var m = Math.sqrt(n);
 for (var i=7;i<=m;i+=30) {
  if (n%i==0)      return i;
  if (n%(i+4)==0)  return i+4;
  if (n%(i+6)==0)  return i+6;
  if (n%(i+10)==0) return i+10;
  if (n%(i+12)==0) return i+12;
  if (n%(i+16)==0) return i+16;
  if (n%(i+22)==0) return i+22;
  if (n%(i+24)==0) return i+24;
 }
 return n;
}

const isPrime = function(n) {
 if (isNaN(n) || !isFinite(n) || n%1 || n<2) return false; 
 if (n==leastFactor(n)) return true;
 return false;
}
/*
*/
function nThPrime(n) {

    let i=2;

     

    while(n>0)

    {


        if(isPrime(i))

          n--;

        

        i++;

    }

    i-=1;

    return i;
    
}

btn.addEventListener('click',(e) => {
	// prevent the form from submitting
	e.preventDefault();
	const formData = new FormData(form);
        //const values = [...formData.entries()];
        num = 0 + parseInt(formData.get('number'));    
	//alert(num);
	inp.innerHTML = num;
	let no = inp.value;
        //alert("no is: " + no);
	let facti = factors(Number(no));
	fact.innerHTML = '';
	let dj = nThPrime(no);
	for(let i = 0; i < facti.length; i++) {
			opt = document.createElement('option');
			opt.innerHTML = facti[i];
			fact.appendChild(opt);
	}                                
	
	
	//alert(facti.length);
	/*
	*/
	let d = no + 1;
	tbl = document.getElementById("out1");
	tbl.textContent = '';
	/* */
        let p0 = '<th class="myDiv"> Commodity </th>';
	let th = document.createElement('thead');
	th.innerHTML = p0;
	tbl.appendChild(th);
	let pa = 'Total Inventory: ' + dj + " Items";
	let pb = 'Total Worth: ' + no + " Units";
	let djc = ~~(dj / 8766);
	let djd = dj % 8766;
	let djf = ~~(djd / 24);
	let dje = ~~(djd % 24);
	let pc = ".................";
	let bra = [pa,pb,pc];
	for(i=0;i<bra.length;i++) {
		pre = document.createElement("tr");
		tbl.appendChild(pre);
		prd = document.createElement("td");
		prd.innerHTML ='<i><b>' +  bra[i] + '</b></i>';
		pre.appendChild(prd);
	}
	let ga = factors(Number(no));
	let gq = [...ga.keys()].filter(i=>isPrime(i));
	let qa = 'Possible UniDists:' + facti.length;
	let qb = 'Possible PriDists:' + gq.length;
	let bre = [qa,qb];
	for(k=0;k<bre.length;k++) {
		pre = document.createElement("tr");
		tbl.appendChild(pre);
		prd = document.createElement("td");
		prd.innerHTML = '<code>' + bre[k]; + '</code>';
		pre.appendChild(prd);
	}
	
	px = (dj - no) / 2;
    py = px - no;
    pyz = py / dj;
    pz = px /dj;
    div3 = document.querySelector(".div3");
    div3.textContent = '';
	let h1 = document.createElement('p');
    h1.className = "myDiv";
    h1.innerHTML = '<b> Finance </b> &#58;&#58;&#64;&#58;&#58 ' + no;
    div3.appendChild(h1);
    let sa = "Gross PayBack: " + px;
    let sb = "Net PayBack: " + py;
    let sc = "Net Hourly Rate: " + pyz.toFixed(2);
    let sd = "Gross Hourly Rate: " + pz.toFixed(2);
    let se = "Pay Back Period: " + djc + " year(s)" +" "+ djf + " day(s)" + " " + dje + " hour(s)";
    let brd = [sa,sb,sc,sd,se];
    for(i=0;i<brd.length;i++) {
        pre = document.createElement("p");         pre.innerHTML = brd[i];
        div3.appendChild(pre);
        
    };
    
});

btn2.addEventListener('click',(e2) => {
	e2.preventDefault();
	const formData = new FormData(form);           
	//const values = [...formData.entries()];     
	num = 0 + parseInt(formData.get('number'));    
	fac = 0 + parseInt(formData.get('factor'));
	//alert(fac);
	//alert(num);                                  
	inp.innerHTML = num;                           
	let no = parseInt(inp.value);
    div5.textContent = '';
	//alert(no);
	let v0 = "Unity Distribution &#58;&#58;&#64;&#58;&#58 " + fac;
	let p00 = document.createElement('p');
	p00.innerHTML = '<b>' + v0 + '</b>';
	p00.className = "myDiv";
	div5.appendChild(p00);
	let va = "Persons: " + fac;
	pap = no / fac;
	let vb = "Per PayBack: " + pap;
	let pri1 = nThPrime(pap);
	dis1 = fac * pri1;
	let vc = "Total Items Distributed: " + dis1;
	let pri2 = nThPrime(no);
	sup1 = pri2 - dis1;
	let vd = "Surplus: " + sup1;
	/**/
	let sup = primes(sup1);
	let pq = Number(sup.length);
	yz = pq/no;
	let ve = "Balance: " + pq;
	let vf = "Percent Yield: " + yz.toFixed(2);
	let brc = [va,vb,vc,vd,ve,vf];  
	for(let x=0;x<brc.length;x++) { 
	    prd = document.createElement("p");
		prd.innerHTML = brc[x];
		div5.appendChild(prd);  
	    
	}
});
	    </script>
    </div> 
  </body>
</html>
